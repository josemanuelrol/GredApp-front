import{a as R,b as W}from"./chunk-Y5LGHVFW.js";import{a as N}from"./chunk-OHSN5WVE.js";import"./chunk-UQKURZOD.js";import{$ as S,$a as U,Aa as M,Ca as x,E as g,M as v,R as b,Ra as F,Sa as H,T as I,Wa as L,Xa as P,Y as f,Z as C,ab as j,ca as _,f as h,h as T,ha as D,ia as y,l as m,la as w,m as n,o as p,pa as E,s as o,t as a,u as l,w as k,xa as B,za as O}from"./chunk-CJIFZG57.js";import"./chunk-A3OJPA2C.js";import"./chunk-7KGURMOZ.js";import"./chunk-C2IFOWZX.js";import"./chunk-GKGVIQI6.js";import"./chunk-A4HLURUV.js";import"./chunk-G3CV3VGG.js";import"./chunk-JGR3S45Q.js";import"./chunk-ZXS6RTUS.js";import"./chunk-RT2Q4DHF.js";import"./chunk-4U6PRYVA.js";import"./chunk-BE36LD5W.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{e as d}from"./chunk-XD4PSF4R.js";var ht=(()=>{let s=class s{constructor(t,e,i,c){this.loadingController=t,this.alertCtrl=e,this.route=i,this.alertController=c,this.taskListService=h(R),this.router=h(I),this.toastService=h(N),this.alertButtons=[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"delete",handler:()=>{this.taskListService.deleteTaskList(this.taskList._id.$oid).then(r=>{this.toastService.presentSuccessToast("top","Lista de tareas eliminada"),this.taskListService.emitDataUpdatedList(),this.router.navigate(["app/tasks"])}).catch(r=>{this.toastService.presentErrorToast("top","Ha ocurrido un error")})}}],this.alertButtonsTask=[{text:"Cancelar",role:"cancel"},{text:"Crear",role:"create",handler:r=>{if(r[0]!=""){let z={titulo:r[0],descripcion:r[1]};this.taskListService.addTask(this.taskList._id.$oid,z).then(A=>{this.taskListService.emitDataUpdateNewTask()}).catch(A=>{this.toastService.presentErrorToast("top","Ha ocurrido un error")})}}}],this.alertInputsTask=[{placeholder:"Titulo"},{placeholder:"Descripci\xF3n (50 caracteres)",attributes:{maxlength:50}}],this.taskListID=this.route.snapshot.paramMap.get("id"),this.taskList=this.router.getCurrentNavigation().extras.state.data,this.nombreControl=new S(this.taskList.nombre,f.required),this.taskListService.onDataUpdateNewTask().subscribe(()=>this.loadTasksWithOutLoading()),this.taskListService.onDataUpdateDeleteTask().subscribe(()=>this.loadTasksWithOutLoading()),this.taskListService.onDataUpdateCheckedTask().subscribe(()=>this.loadTasksWithOutLoading())}ngOnInit(){console.log()}loadTasks(){this.showLoading(),this.taskListService.getTaskListById(this.taskListID).then(t=>{this.taskList=t,this.taskList.tareas=this.taskList.tareas.filter(e=>!e.completed),this.loadingController.dismiss()}).catch(t=>{this.loadingController.dismiss(),this.toastService.presentErrorToast("top","Ha ocurrido un error")})}loadTasksWithOutLoading(){this.taskListService.getTaskListById(this.taskListID).then(t=>{this.taskList=t,this.taskList.tareas=this.taskList.tareas.filter(e=>!e.completed)}).catch(t=>{this.toastService.presentErrorToast("top","Ha ocurrido un error")})}showLoading(){return d(this,null,function*(){(yield this.loadingController.create({message:"Loading..."})).present()})}onDelete(){return d(this,null,function*(){yield(yield this.alertCtrl.create({header:"\xBFDesea eliminar esta lista?",message:"Esta lista ser\xE1 eliminada permanentemente",buttons:this.alertButtons})).present()})}createTask(){return d(this,null,function*(){yield(yield this.alertController.create({header:"Crear tarea",buttons:this.alertButtonsTask,inputs:this.alertInputsTask})).present()})}onBack(){let t={nombre:this.nombreControl.getRawValue()};this.taskList.nombre!=t.nombre&&this.taskListService.updateTaskList(this.taskList._id.$oid,t).then(e=>{this.taskListService.emitDataUpdatedList()}).catch(e=>{this.toastService.presentErrorToast("top","Ha ocurrido un error")})}};s.\u0275fac=function(e){return new(e||s)(n(P),n(L),n(b),n(L))},s.\u0275cmp=T({type:s,selectors:[["app-task-list-detail"]],standalone:!0,features:[g],decls:16,vars:3,consts:[["collapse","condense",1,"ion-no-border"],["color","light"],["slot","start","color","dark",3,"click","disabled"],["slot","end","fill","clear","color","danger",3,"click"],["slot","icon-only","name","trash-outline"],["slot","fixed","vertical","bottom","horizontal","end"],["size","small","color","danger",3,"click"],["name","add"],["size","large"],[1,"title"],["name","list"],["type","text","placeholder","Titulo de la lista...","errorText","El nombre es requerido",3,"formControl"],[1,"mainTaskList"],[3,"mainTaskList"]],template:function(e,i){e&1&&(o(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-back-button",2),k("click",function(){return i.onBack()}),a(),o(3,"ion-button",3),k("click",function(){return i.onDelete()}),l(4,"ion-icon",4),a()()(),o(5,"ion-content",1)(6,"ion-fab",5)(7,"ion-fab-button",6),k("click",function(){return i.createTask()}),l(8,"ion-icon",7),a()(),o(9,"ion-header")(10,"ion-title",8)(11,"div",9),l(12,"ion-icon",10)(13,"ion-input",11),a()()(),o(14,"div",12),l(15,"app-task-list",13),a()()),e&2&&(m(2),p("disabled",i.nombreControl.invalid),m(11),p("formControl",i.nombreControl),m(2),p("mainTaskList",i.taskList))},dependencies:[M,O,y,C,_,j,W,U,E,w,B,x,F,H,v,D],styles:["ion-header[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}"]});let u=s;return u})();export{ht as TaskListDetailPage};
