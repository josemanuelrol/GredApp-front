import{a as q}from"./chunk-ZDRTFGTT.js";import{a as G}from"./chunk-OHSN5WVE.js";import"./chunk-UQKURZOD.js";import{$ as m,Ba as L,Ca as F,E as w,Ea as R,Ia as B,Ja as M,Ka as j,La as H,M as b,Oa as V,Ra as x,Sa as z,T as E,Wa as A,Xa as N,Y as C,Z as _,ab as O,ca as y,f as d,h as S,ha as D,ia as T,l as c,la as k,m as g,n as f,o as h,p as I,s as t,t as i,u as v,w as p,wa as P,xa as U,y as a}from"./chunk-CJIFZG57.js";import"./chunk-A3OJPA2C.js";import"./chunk-7KGURMOZ.js";import"./chunk-C2IFOWZX.js";import"./chunk-GKGVIQI6.js";import"./chunk-A4HLURUV.js";import"./chunk-G3CV3VGG.js";import"./chunk-JGR3S45Q.js";import"./chunk-ZXS6RTUS.js";import"./chunk-RT2Q4DHF.js";import"./chunk-4U6PRYVA.js";import"./chunk-BE36LD5W.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{e as u}from"./chunk-XD4PSF4R.js";function J(l,n){l&1&&(t(0,"ion-note",5),a(1," El nombre de usuario o el email no son v\xE1lidos o est\xE1n vacios "),i())}var ae=(()=>{let n=class n{constructor(o,e){this.loadingController=o,this.alertCtrl=e,this.userService=d(q),this.toastService=d(G),this.router=d(E),this.usernameControl=new m,this.emailControl=new m,this.user={},this.userID=""}ngOnInit(){this.showLoading(),this.userID=localStorage.getItem("userID"),this.userService.getUserById(this.userID).then(o=>{this.user=o,this.usernameControl=new m(this.user.username,C.required),this.emailControl=new m(this.user.email,[C.required,C.email]),this.loadingController.dismiss()}).catch(o=>{this.loadingController.dismiss(),this.toastService.presentErrorToast("top","Ha ocurrido un error")})}showLoading(){return u(this,null,function*(){(yield this.loadingController.create({message:"Loading..."})).present()})}onBack(){if(this.user.username!=this.usernameControl.getRawValue()||this.user.email!=this.emailControl.getRawValue()){let o={username:this.usernameControl.getRawValue(),email:this.emailControl.getRawValue()};this.userService.updateUser(this.userID,o).then(e=>{this.toastService.presentSuccessToast("top","El usuario se ha modificado")}).catch(e=>{this.toastService.presentErrorToast("top","Ha ocurrido un error")})}}onChangePassword(){return u(this,null,function*(){yield(yield this.alertCtrl.create({header:"Cambiar contrase\xF1a",buttons:[{text:"Cancelar",role:"cancel"},{text:"Cambiar",role:"change",handler:e=>{let r={password:e[0],newPassword:e[1],confirmPassword:e[2]};this.userService.cambiarContrase\u00F1a(this.userID,r).then(s=>{this.toastService.presentSuccessToast("top",s.mensaje)}).catch(s=>{this.toastService.presentErrorToast("top",s.error.error)})}}],inputs:[{placeholder:"Contrase\xF1a actual",type:"password"},{placeholder:"Nueva contrase\xF1a",type:"password"},{placeholder:"Confirmar contrase\xF1a",type:"password"}]})).present()})}onDeleteAccount(){return u(this,null,function*(){yield(yield this.alertCtrl.create({header:"\xBFDesea eliminar su cuenta?",message:"Esta cuenta se eliminar\xE1 permanentemente y perder\xE1 todos sus datos",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"delete",handler:()=>{this.userService.deleteUser(this.userID).then(e=>{this.router.navigate(["auth"]),this.toastService.presentSuccessToast("top","Su cuenta ha sido eliminada correctamente")}).catch(e=>{this.toastService.presentErrorToast("top","Ha ocurrido un error")})}}]})).present()})}};n.\u0275fac=function(e){return new(e||n)(g(N),g(A))},n.\u0275cmp=S({type:n,selectors:[["app-user-detail"]],standalone:!0,features:[w],decls:28,vars:4,consts:[["collapse","condense",1,"ion-no-border"],["color","light"],["slot","start","color","dark",3,"click","disabled"],[1,"ion-justify-content-center","ion-align-items-center"],["size","12","sizeLg","8"],["color","danger",1,"ion-margin-horizontal"],["inset","true"],["label","Usuario",3,"formControl"],["label","Email",3,"formControl"],["button","",3,"click"],["color","danger"]],template:function(e,r){e&1&&(t(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),a(3,"Perfil"),i(),t(4,"ion-back-button",2),p("click",function(){return r.onBack()}),i()()(),t(5,"ion-content",1)(6,"ion-grid")(7,"ion-row",3)(8,"ion-col",4)(9,"ion-list-header"),a(10,"Tu usuario"),i(),f(11,J,2,0,"ion-note",5),t(12,"ion-list",6)(13,"ion-item"),v(14,"ion-input",7),i(),t(15,"ion-item"),v(16,"ion-input",8),i()()()(),t(17,"ion-row",3)(18,"ion-col",4)(19,"ion-list-header"),a(20,"Opciones"),i(),t(21,"ion-list",6)(22,"ion-item",9),p("click",function(){return r.onChangePassword()}),t(23,"ion-label"),a(24,"Cambiar contrase\xF1a"),i()(),t(25,"ion-item",9),p("click",function(){return r.onDeleteAccount()}),t(26,"ion-label",10),a(27,"Eliminar cuenta"),i()()()()()()()),e&2&&(c(4),h("disabled",r.usernameControl.invalid||r.emailControl.invalid),c(7),I(11,r.usernameControl.invalid||r.emailControl.invalid?11:-1),c(3),h("formControl",r.usernameControl),c(2),h("formControl",r.emailControl))},dependencies:[H,T,_,y,O,B,R,j,M,P,L,V,k,U,F,x,z,b,D],styles:["ion-note[_ngcontent-%COMP%]{display:block}"]});let l=n;return l})();export{ae as UserDetailPage};
