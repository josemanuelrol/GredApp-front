import{a as J}from"./chunk-Y5LGHVFW.js";import{a as G}from"./chunk-OHSN5WVE.js";import"./chunk-UQKURZOD.js";import{A as T,Ca as $,E as y,Ea as H,Fa as U,Ga as V,Ha as B,Ia as j,Ja as z,M,Ra as N,Sa as R,T as P,Xa as q,Za as A,f as p,h as C,ha as w,i as k,j as g,l,la as F,m as f,n as I,o as v,p as L,q as S,r as x,s as n,t as a,u as b,v as D,w as u,x as h,xa as O,y as m,z as E}from"./chunk-CJIFZG57.js";import"./chunk-A3OJPA2C.js";import"./chunk-7KGURMOZ.js";import"./chunk-C2IFOWZX.js";import"./chunk-GKGVIQI6.js";import"./chunk-A4HLURUV.js";import"./chunk-G3CV3VGG.js";import"./chunk-JGR3S45Q.js";import"./chunk-ZXS6RTUS.js";import"./chunk-RT2Q4DHF.js";import"./chunk-4U6PRYVA.js";import"./chunk-BE36LD5W.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{e as _}from"./chunk-XD4PSF4R.js";var Q=(s,o)=>o._id;function W(s,o){if(s&1&&(n(0,"ion-label"),m(1),a()),s&2){let r=h().$implicit;l(),T(" ",r.descripcion," ")}}function X(s,o){if(s&1){let r=D();n(0,"ion-item-sliding")(1,"ion-item",5)(2,"ion-checkbox",6),u("ionChange",function(t){let i=k(r).$implicit,c=h();return g(c.onClick(i,t))}),n(3,"ion-label"),m(4),a(),I(5,W,2,1,"ion-label"),a()(),n(6,"ion-item-options")(7,"ion-item-option",7),u("click",function(){let t=k(r).$implicit,i=h();return g(i.onDelete(t))}),m(8,"Eliminar"),a()()()}if(s&2){let r=o.$implicit;l(2),v("checked",r.completed),l(2),T(" ",r.titulo," "),l(),L(5,r.descripcion?5:-1)}}var pe=(()=>{let o=class o{constructor(e){this.loadingController=e,this.tasksListService=p(J),this.router=p(P),this.toastService=p(G),this.emptyMessage="",this.userID=localStorage.getItem("userID"),this.taskLists=[],this.tasks=[],this.tasksListService.onDataUpdateCheckedTask().subscribe(()=>this.loadCompletedTask()),this.tasksListService.onDataUpdateDeleteTask().subscribe(()=>this.loadCompletedTask())}ngOnInit(){this.showLoading(),this.tasksListService.getCompletedTasks(this.userID).then(e=>{this.tasks=e,this.checkEmptyListTask(),this.tasksListService.getTasksByUser(this.userID).then(t=>{this.taskLists=t}),this.loadingController.dismiss()}).catch(e=>{this.loadingController.dismiss(),this.toastService.presentErrorToast("top","Ha ocurrido un error")})}loadCompletedTask(){this.tasksListService.getCompletedTasks(this.userID).then(e=>{this.tasks=e,this.checkEmptyListTask()}).catch(e=>{this.toastService.presentErrorToast("top","Ha ocurrido un error")})}showLoading(){return _(this,null,function*(){(yield this.loadingController.create({message:"Loading..."})).present()})}onClick(e,t){let i={completed:t.detail.checked},c=this.findTaskListIdFromTask(this.taskLists,e);this.tasksListService.updateTask(c,e._id.$oid,i).then(d=>{this.tasksListService.emitDataUpdateCheckedTask()}).catch(d=>{this.toastService.presentErrorToast("top","Ha ocurrido un error")})}onDelete(e){let t=this.findTaskListIdFromTask(this.taskLists,e);this.tasksListService.deleteTask(t,e._id.$oid).then(i=>{this.toastService.presentSuccessToast("top","Tarea eliminada"),this.tasksListService.emitDataUpdateDeleteTask()}).catch(i=>{this.toastService.presentErrorToast("top","Ha ocurrido un error")})}findTaskListIdFromTask(e,t){var c;let i="";for(let d=0;d<e.length;d++)(c=e[d].tareas)==null||c.map(K=>{K._id.$oid==t._id.$oid&&(i=e[d]._id.$oid)});return i}checkEmptyListTask(){this.tasks.length==0&&(this.emptyMessage="No tienes tareas completadas")}};o.\u0275fac=function(t){return new(t||o)(f(q))},o.\u0275cmp=C({type:o,selectors:[["app-completed-tasks"]],standalone:!0,features:[y],decls:13,vars:1,consts:[["collapse","condense",1,"ion-no-border"],["color","light"],["slot","start","color","dark"],["size","large"],[1,"mainTaskList","ion-padding"],["lines","none"],["color","danger","labelPlacement","end","justify","start",3,"ionChange","checked"],["color","danger",3,"click"]],template:function(t,i){t&1&&(n(0,"ion-header",0)(1,"ion-toolbar",1),b(2,"ion-back-button",2),a()(),n(3,"ion-content",1)(4,"ion-header")(5,"ion-title",3),m(6,"Tareas completadas"),a()(),n(7,"div",4)(8,"ion-list"),S(9,X,9,3,"ion-item-sliding",null,Q),a(),n(11,"ion-label"),m(12),a()()()),t&2&&(l(9),x(i.tasks),l(3),E(i.emptyMessage))},dependencies:[V,U,A,H,B,z,j,F,O,$,N,R,M,w],styles:["ion-item[_ngcontent-%COMP%] > ion-checkbox[_ngcontent-%COMP%] > ion-label[_ngcontent-%COMP%]:nth-child(2){font-size:14px;opacity:.6}ion-item-sliding[_ngcontent-%COMP%]{border-radius:6px}ion-list[_ngcontent-%COMP%]{border-radius:12px}.mainTaskList[_ngcontent-%COMP%] > ion-label[_ngcontent-%COMP%]{padding-left:16px;font-size:22px;font-weight:500;margin-bottom:4px}"]});let s=o;return s})();export{pe as CompletedTasksPage};
